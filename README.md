# Recon Toolkit

A reconnaissance toolkit for pentesters and bug hunters to gather IPs, subdomains, endpoints and CNAMEs.

## Controller

This toolkit also contains a controller.sh script, with an interactive menu that allows to choose which tool to use and define the variables for execution.

## Scripts

### Gather All URLs

This one gathers URLs from Web Applications through both spidering (with Katana) and Wayback Machine (with waybackurls).
Optionally, also allows to filter the outputed URLs so to see just the one's who matches some pattern related to Vulns (with gf patterns).

#### Requirements

- Katana
  - ```go install github.com/projectdiscovery/katana/cmd/katana@latest```
- WaybackURLs
  - ```go install github.com/tomnomnom/waybackurls@latest```
- Gf
  - ```go install -v github.com/tomnomnom/gf@master ```
- Anew
  - ```go install -v github.com/tomnomnom/anew@latest```

#### Usage

```
Usage: ./gatherAllUrls.sh <SUBS_LIST> [-vulns]
```

---

### Gather CNAMEs

Given a list of subdomains, it looks for which ones have DNS CNAME entries, so to give information for subdomain takeover investigation.

#### Usage

```
Usage: ./gatherCnames.sh <SUBS_LIST>
```

---

### Gather Subdomains

Given a list of domains to scan, uses multiple tools and methods to discover active subdomains for each target.

#### Requirements

- [Golang](https://go.dev/doc/install)
- Subfinder
  - ```go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest```
  - Configure the API Keys file at ~/.config/subfinder/provider-config.yaml
- [Sublist3r](https://github.com/aboul3la/Sublist3r)
- Amass
  - ```go install -v github.com/OWASP/Amass/v3/...@master```
  - Configure the API Keys file at ~/.config/amass/config.ini
- Assetfinder
  - ```go install -v github.com/tomnomnom/assetfinder@master```
- PureDNS
  - ```go install github.com/d3mondev/puredns/v2@latest```
- Gotator
  - ```go install github.com/Josue87/gotator@latest```
- Anew
  - ```go install -v github.com/tomnomnom/anew@latest```
  
#### Usage

```
Usage: ./scripts/gatherSubs.sh <DOMAINS_FILE>
```

---

### Unique URLs

Given a list of URLs (the one generated by gatherAllUrls.sh also applies ðŸ™ƒ), this script helps you to clean it up and exclude repetitive stuff, so if there are two URLs with the same hostname, path and query params, it leaves just one of the occurrences. 

For example, given the URL: https://attacker.com/first/file?arg=something&other=else

| URL  | Equivalent? | Why? |
| ------------- | ------------- | ------------- |
| https://attacker2.com/first/file?arg=something&other=else  | No  | Different host  |
| https://attacker.com/second/file?arg=something&other=else  | No  | Different path  |
| https://attacker.com/first/file?arg=something&other=else&onemore=value  | No  | Different query params  |
| https://attacker.com/first/file?other=blah&arg=some  | Yes  | Same host, path and params  |

The tool also accepts an optional list of initial paths that it should consider the same, no matter the subdirectories inside of it. 

So if I notice that , for example, I can pass  

For example, given the blog URL https://attacker.com/blog/posts/pentest?post=something&other=else, I notice that all post categories follow the same pattern, so I pass ```/blog/posts/``` as an element of the exception list. We'll have the following result:

| URL  | Equivalent? | Why? |
| ------------- | ------------- | ------------- |
| https://attacker2.com/blog/posts/pentest?post=something&other=else  | No  | Different host  |
| https://attacker.com/blog/articles/pentest?post=something&other=else  | No  | Different path  |
| https://attacker.com/blog/articles/pentest?post=something&other=else&onemore=value  | No  | Different query params  |
| https://attacker.com/blog/posts/cloud?post=some&other=else&onemore=value  | No  | Different query params  |
| https://attacker.com/blog/posts/pentest?other=blah&post=some  | Yes  | Same host, path and params  |
| https://attacker.com/blog/posts/cloud?post=some&other=else  | Yes  | Same host, path and params  |

This last comparison takes into account the passed path ```/blog/posts/```, so the subdirectories or file inside of it are not taken into account.

---

### Gather IPs - Passive

Given an IP or network address, searches through multiple engines and DBs to passively find valid hosts and services.

#### Requirements
- API Keys for Shodan, Censys and ZoomEye

- Shodan CLI configuration
  - ```pip3 install shodan```
  - ```shodan init <API_KEY>```
  
- Censys CLI configuration
  - ```pip3 install censys```
  - ```censys config```
  
- Update the zoomeyeSearch function to use your API Key

#### Usage

```
Usage: ./scripts/gatherIPs_passive.sh [options] <IP or NETWORK>

Options:
  -h, --help      Show this help message and exit
  -s, --shodan    Query Shodan for information about a host
  -c, --censys    Query Censys for information about a host
  -z, --zoomeye   Query ZoomEye for information about a host
  no option        Run all the above services
```
